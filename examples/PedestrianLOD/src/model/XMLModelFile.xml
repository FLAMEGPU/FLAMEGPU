<?xml version="1.0" encoding="utf-8"?>
<gpu:xmodel xmlns:gpu="http://www.dcs.shef.ac.uk/~paul/XMMLGPU"
        xmlns="http://www.dcs.shef.ac.uk/~paul/XMML">
    <name>Optional </name>
    <gpu:environment>
    <gpu:constants>
      
        <gpu:variable> 
            <type>float</type>
            <name>TIME_SCALER</name>
        </gpu:variable> 
        
         <gpu:variable>
            <type>float</type>
            <name>STEER_WEIGHT</name>
        </gpu:variable> 
        <gpu:variable>
            <type>float</type>
            <name>AVOID_WEIGHT</name>
        </gpu:variable> 
        <gpu:variable>
            <type>float</type>
            <name>COLLISION_WEIGHT</name>
        </gpu:variable> 
        <gpu:variable>
            <type>float</type>
            <name>GOAL_WEIGHT</name>
        </gpu:variable> 
        
        <gpu:variable>
            <type>float</type>
            <name>EYE_X</name>
        </gpu:variable> 
        <gpu:variable>
            <type>float</type>
            <name>EYE_Y</name>
        </gpu:variable> 
        <gpu:variable>
            <type>float</type>
            <name>EYE_Z</name>
        </gpu:variable> 
        
        
    </gpu:constants>
        <gpu:functionFiles>
            <file>functions.c</file>
        </gpu:functionFiles>
    </gpu:environment>
    <xagents>
        <gpu:xagent>
            <name>agent</name>
            <memory>
                <gpu:variable>
                    <type>float</type>
                    <name>x</name>
                </gpu:variable>
                <gpu:variable>
                    <type>float</type>
                    <name>y</name>
                </gpu:variable>
                <gpu:variable>
                    <type>float</type>
                    <name>velx</name>
                </gpu:variable>
                <gpu:variable>
                    <type>float</type>
                    <name>vely</name>
                </gpu:variable>
                <gpu:variable>
                    <type>float</type>
                    <name>steer_x</name>
                </gpu:variable>
                <gpu:variable>
                    <type>float</type>
                    <name>steer_y</name>
                </gpu:variable>
                <gpu:variable>
                    <type>float</type>
                    <name>height</name>
                </gpu:variable>
              <gpu:variable>
                <type>int</type>
                <name>exit_no</name>
              </gpu:variable>
              <gpu:variable>
                <type>float</type>
                <name>speed</name>
              </gpu:variable>
                <!-- rendering and animation variables-->
                <gpu:variable>
                    <type>int</type>
                    <name>lod</name>
                </gpu:variable>
                <gpu:variable>
                    <type>float</type>
                    <name>animate</name>
                </gpu:variable>
                <gpu:variable>
                    <type>int</type>
                    <name>animate_dir</name>
                </gpu:variable>
            </memory>
            <functions>

                <gpu:function>
                    <name>output_pedestrian_location</name>
                    <currentState>default</currentState>
                    <nextState>default</nextState>
                    <outputs>
                        <gpu:output>
                            <messageName>pedestrian_location</messageName>
                            <gpu:type>single_message</gpu:type>
                        </gpu:output>
                    </outputs>
                    <gpu:reallocate>false</gpu:reallocate>
                    <gpu:RNG>false</gpu:RNG>
                </gpu:function>

                <gpu:function>
                    <name>avoid_pedestrians</name>
                    <currentState>default</currentState>
                    <nextState>default</nextState>
                    <inputs>
                        <gpu:input>
                            <messageName>pedestrian_location</messageName>
                        </gpu:input>
                    </inputs>
                    <gpu:reallocate>false</gpu:reallocate>
                    <gpu:RNG>true</gpu:RNG>
                </gpu:function>

                <gpu:function>
                    <name>move</name>
                    <currentState>default</currentState>
                    <nextState>default</nextState>
                    <gpu:reallocate>false</gpu:reallocate>
                    <gpu:RNG>false</gpu:RNG>
                </gpu:function>
            </functions>

            <states>
                <gpu:state>
                    <name>default</name>
                </gpu:state>
                <initialState>default</initialState>
            </states>

            <gpu:type>continuous</gpu:type>
            <gpu:bufferSize>16384</gpu:bufferSize>
        </gpu:xagent>

    </xagents>

    <messages>
        <gpu:message>
            <name>pedestrian_location</name>
            <variables>
                <gpu:variable>
                    <type>float</type>
                    <name>x</name>
                </gpu:variable>
                <gpu:variable>
                    <type>float</type>
                    <name>y</name>
                </gpu:variable>
                <gpu:variable>
                    <type>float</type>
                    <name>z</name>
                </gpu:variable>
            </variables>
            <gpu:partitioningSpatial>
                <gpu:radius>0.025</gpu:radius>
                <gpu:xmin>-2.0</gpu:xmin>
                <gpu:xmax>2.0</gpu:xmax>
                <gpu:ymin>-2.0</gpu:ymin>
                <gpu:ymax>2.0</gpu:ymax>
                <gpu:zmin>0.0</gpu:zmin>
                <gpu:zmax>0.025</gpu:zmax>
            </gpu:partitioningSpatial>
            <gpu:bufferSize>16384</gpu:bufferSize>
        </gpu:message>

       

    </messages>

<layers>
    <layer>
        <gpu:layerFunction>
            <name>output_pedestrian_location</name>
        </gpu:layerFunction>
    </layer>
    <layer>
        <gpu:layerFunction>
            <name>avoid_pedestrians</name>
        </gpu:layerFunction>
    </layer>
    <layer>
        <gpu:layerFunction>
            <name>move</name>
        </gpu:layerFunction>
    </layer>
</layers>


</gpu:xmodel>
